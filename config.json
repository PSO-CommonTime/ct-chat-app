{"id":"104f3331-ee08-4a5e-b16a-2c7093d7a2bb","version":"1.0.0","icon":"other","splash":"default","splashdata":{},"settings":{"router":{"mode":"single","animation":"off"},"theme":"default","push-notifications":{"android":{"enabled":false},"ios":{"enabled":false},"wp":{"enabled":false}},"provisioning":{"enabled":false,"manifest":"","poll":2,"manual":false,"wifionly":true},"crashReporting":{"enabled":false,"androidEnabled":false,"iosEnabled":false,"splunkAndroidApiKey":"","splunkIosApiKey":"","splunkExtraData":""},"kioskMode":{"enabled":false},"loading-message":true},"language":{"defaultLocale":"en_GB","initialLanguage":"","useDeviceLocale":true},"metadata":{"xmppHost":"localhost"},"name":"Nicord","packageId":"com.commontime.infinity.Nicord","schemaVersion":18,"minimumStudioVersion":"3.0.0","pages":[{"start":true,"name":"Splash","config":[],"content":[{"name":"staticLogin","type":"area","item-type":"static","_auto_id_":"8f4f8eb1-ba92-4039-8594-65a3fe762b02","content":[{"name":"htmlSplash","type":"content","item-type":"html","_auto_id_":"f6c3f37a-2250-48b3-b4f6-d489bbfd3c7e","content":"<h1>Nicord</h1>\n\n<h4>A complete chat app</h4>","expressions":{}},{"name":"txtUsername","type":"user-input","item-type":"text","_auto_id_":"07503bee-add7-4841-a352-38adb8d69ca1","label":"","required":true,"multiline":false,"debounce":250,"expressions":{},"actions":[],"validators":[],"placeholder":"Username...","message":"This is a required field"},{"name":"pwdPassword","type":"user-input","item-type":"password","_auto_id_":"9011ab75-87af-4098-81fc-a6b1663144c7","label":"","required":true,"message":"This is a required field","expressions":{},"actions":[],"validators":[],"placeholder":"Password..."},{"name":"btnLogin","type":"button","item-type":"button","_auto_id_":"eebb1a21-1397-430e-9b66-ff0389b0303d","content":"Login","theme":"default","expressions":{"disabled":"$form.invalid === true"},"actions":[{"event":"click","type":"xmpp-login","data":{"name":"xmppChatbox","username":"{{$store.pages.Splash.txtUsername.toLowerCase()}}@localhost","password":"{{$store.pages.Splash.pwdPassword}}"},"_auto_id_":"bf19dd7c-4a23-4ca5-9620-1611925bd693"}]}],"expressions":{}}]},{"start":false,"name":"Friends","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"45c01a12-f1c1-4771-90e2-2967c6da1cf8","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"var filter = cti.store.friendsState.filter;\n\nswitch(filter) {\n\tcase 'all': \n\t\tdocument.querySelector('#staticTabs div#btnAll').setAttribute('classes', 'selected');\n\t\tbreak;\n\tcase 'online':\n\t\tdocument.querySelector('#staticTabs div#btnOnline').setAttribute('classes', 'selected');\n\t\tbreak;\n\tcase 'pending':\n\t\tdocument.querySelector('#staticTabs div#btnPending').setAttribute('classes', 'selected');\n\t\tbreak;\n\tdefault:\n\t\tdocument.querySelector('#staticTabs div#btnAll').setAttribute('classes', 'selected');\n\t\tbreak;\n}"},"_auto_id_":"585bfa48-2374-4fe6-a218-512d2a803316"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnMenu","type":"button","item-type":"button","_auto_id_":"57ceaced-e301-4194-9db8-80787709c316","content":"","theme":"default","left-icon":"fa-bars","expressions":{},"actions":[{"event":"click","type":"call-component-function","data":{"page":"Friends","componentInstanceId":"edeec319-d729-4313-82dd-e5a31a3f0207","function":"toggle"},"_auto_id_":"3dacfd35-fd0a-4781-a211-fe40a2d3651a"}]},{"name":"title","type":"content","item-type":"title","content":"<h1>Friends</h1>","_auto_id_":"b76db5dc-bab7-4c9f-9891-8f71d3e8c7b5"},{"name":"btnNewMessage","type":"button","item-type":"button","_auto_id_":"09f921e5-b48d-402e-a940-edb0720aabde","content":"","theme":"default","left-icon":"fa-edit","expressions":{},"actions":[{"event":"click","type":"call-component-function","data":{"page":"Friends","componentInstanceId":"f65a66ce-5511-4ab9-86e6-e97653864ead","function":"show"},"_auto_id_":"e63d9ec5-8966-4dc4-81f3-2eec232c2c6f"}]},{"name":"btnAddFriend","type":"button","item-type":"button","_auto_id_":"5b6acd3b-5fe2-4071-8d74-c7dd2bb3a466","content":"","theme":"default","left-icon":"fa-user-plus","expressions":{},"actions":[{"event":"click","type":"call-component-function","data":{"page":"Friends","componentInstanceId":"9ba4c4ea-0f0d-4693-8711-814da92c6282","function":"togglePopup"},"_auto_id_":"b516f7c1-f8e2-4f2c-b220-be87f132864a"}]}],"_auto_id_":"498a4901-4a1d-494c-8dee-fb7873ea6311"},{"name":"staticTabs","type":"area","item-type":"static","_auto_id_":"e160bd0a-d100-4a8f-b4dc-905db53ab1b4","content":[{"name":"btnAll","type":"button","item-type":"button","_auto_id_":"fdafb538-4570-47bc-9cba-d9a603a819f8","content":"All","theme":"default","expressions":{},"classes":"","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"document.querySelector('#staticTabs div[classes=\"selected\"]').setAttribute('classes', '');\ndocument.querySelector('#staticTabs div#btnAll').setAttribute('classes', 'selected');\n\ncti.store.friendsState = { \n  filter: 'all',\n  list: cti.store.xmpp.xmppChatbox.contacts\n}\n\n$success();"},"_auto_id_":"57a093da-8bdf-4094-a516-17a8a1dae007","actions":[]}]},{"name":"btnOnline","type":"button","item-type":"button","_auto_id_":"26ffec68-9cb1-44c0-b679-be0115c2238c","content":"Online","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"document.querySelector('#staticTabs div[classes=\"selected\"]').setAttribute('classes', '');\ndocument.querySelector('#staticTabs div#btnOnline').setAttribute('classes', 'selected');\n\nvar list = [];\n\nfor(var i = 0, max = cti.store.xmpp.xmppChatbox.contacts.length; i < max; i++) {\n\tvar c = cti.store.xmpp.xmppChatbox.contacts[i];\n\n\tif(c.status === 'chat') {\n\t\tlist.push(c);\n\t}\n}\n\ncti.store.friendsState = {\n\tfilter: 'online',\n\tlist: list\n}\n\n$success();"},"_auto_id_":"423dd03f-d1ab-4ec8-9e8a-c91e461859e9","actions":[]}]},{"name":"btnPending","type":"button","item-type":"button","_auto_id_":"cffb8c66-3e90-46c4-b77a-c2597b4b22e0","content":"Pending","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"document.querySelector('#staticTabs div[classes=\"selected\"]').setAttribute('classes', '');\ndocument.querySelector('#staticTabs div#btnPending').setAttribute('classes', 'selected');\n\nvar list = [];\n\nfor(var i = 0, max = cti.store.xmpp.xmppChatbox.contacts.length; i < max; i++) {\n\tvar c = cti.store.xmpp.xmppChatbox.contacts[i];\n\n\tif(c.subscriptionStatus === 'none' || c.subscriptionStatus === 'awaiting') {\n\t\tlist.push(c);\n\t}\n}\n\ncti.store.friendsState = {\n\tfilter: 'pending',\n\tlist: list\n}\n\n$success();"},"_auto_id_":"ee917967-da8e-4bbc-9f17-53047d66d7a1"}]},{"name":"btnBots","type":"button","item-type":"button","_auto_id_":"2eb421b2-3bb6-4038-88c8-8fc0c84af464","content":"Bots","theme":"default","expressions":{},"actions":[]}],"expressions":{}},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"lstUsers","type":"content","item-type":"list","_auto_id_":"2d1082f1-4aeb-4df2-afda-84c52e95dec6","title":"List","edit":false,"search":false,"static":false,"row":"<div class=\"userRow\">\n  <p class=\"userIcon {{$data.$item.status}}\"><span class=\"icon\">\n    <img src=\"{{$data.$item.vcard.avatar || $store.variables.defaultAvyPlaceholder}}\" width=\"45\" height=\"45\" />\n    </span><span class=\"status\"></span></p>\n  <p class=\"user\">\n    {{$data.$item.nickname || $data.$item.username}}\n  </p>\n  <p class=\"subscription {{$data.$item.subscriptionStatus}}\">{{$data.$item.subscriptionStatus === 'none' ? 'pending' : ''}}\n  </p>\n  \n  <p ng-if=\"$data.$item.subscriptionStatus === 'awaiting'\" class=\"subscription\">\n    <span class=\"accept\" onclick=\"xmppExtensions.roster.acceptSubscriptionRequest(event)\" ontouchstart=\"xmppExtensions.roster.acceptSubscriptionRequest(event)\" user=\"{{$data.$item.username}}\">Accept</span>\n    <span class=\"decline\">Decline</span>\n  </p>\n</div>","classes":"","model":"$store.friendsState.list","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var username = $data.$item.username;\ncti.store.selectedUser = $data.$item;\n\nwindow.xmppExtensions.vcard.requestVCard(username, function() {\n  var popup = document.querySelector('ct-page-popup#ppProfile').show();\n});"},"_auto_id_":"9ea3b3ff-6189-4293-bd72-b7f414cce644"},{"event":"click","type":"call-component-function","data":{"page":"Friends","componentInstanceId":"4fc2dd94-2f81-457e-980a-85b0510ee779","function":"show"},"_auto_id_":"85339c00-6580-478c-aec9-0945f806d889"}]}],"_auto_id_":"a4ff0447-1566-4f69-916f-c6739a793cf1"},{"name":"staticComponentsContainer","type":"area","item-type":"static","_auto_id_":"3bce3aea-f83d-4efc-bbe4-08477fcc75c2","content":[{"name":"addFriend","type":"component","item-type":"web-component","content":[{"name":"htmlAddFriend","type":"content","item-type":"html","_auto_id_":"ade20558-d3a5-457e-997f-f212a7c684eb","content":"<p>Add friend:</p>","expressions":{}},{"name":"txtFriendName","type":"user-input","item-type":"text","_auto_id_":"71af9b76-26bf-4c68-88a7-e1cf1a39bb9e","label":"","required":false,"multiline":false,"debounce":250,"expressions":{},"actions":[],"validators":[],"placeholder":"Friend username..."},{"name":"btnRequest","type":"button","item-type":"button","_auto_id_":"dd241f57-4194-4b26-b600-a0787b59f6b4","content":"Send Request","theme":"default","expressions":{},"classes":"yes","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"if(cti.store.pages.Friends) {\n  if(cti.store.pages.Friends.txtFriendName) {\n    window.xmppExtensions.roster.requestRosterSubscription(cti.store.pages.Friends.txtFriendName.trim() + '@' + cti.store.schema.metadata.xmppHost);\n  }\n}\n\ndelete cti.store.pages.Friends.txtFriendName;\n\n$success();"},"_auto_id_":"40a051ff-f460-457b-b63d-65f2cac8026d"},{"event":"click","type":"call-component-function","data":{"page":"Friends","componentInstanceId":"9ba4c4ea-0f0d-4693-8711-814da92c6282","function":"togglePopup"},"_auto_id_":"dca36cc5-384a-4803-88bc-fadd6c1f4011"}]},{"name":"btnClose","type":"button","item-type":"button","_auto_id_":"4a16dfe5-7973-40ed-a551-05c387cf30a6","content":"Cancel","theme":"default","expressions":{},"actions":[{"event":"click","type":"call-component-function","data":{"page":"Friends","componentInstanceId":"9ba4c4ea-0f0d-4693-8711-814da92c6282","function":"togglePopup"},"_auto_id_":"9cbe13ca-3187-41d7-a280-7ce9e52efd90"}],"classes":"no"}],"componentId":"6eade5b7-4ac6-468a-8e75-49a64850f7ba","_auto_id_":"9ba4c4ea-0f0d-4693-8711-814da92c6282","attributes":{},"expressions":{}},{"name":"menuMain","type":"component","item-type":"web-component","content":[{"name":"staticGroups","type":"area","item-type":"static","_auto_id_":"aa976cef-4220-41a5-8a50-73a185ece481","content":[{"name":"lstGroups","type":"content","item-type":"list","_auto_id_":"cb73a6e6-b8b2-4850-9aca-9e67a02cc153","title":"List","edit":false,"search":false,"static":true,"row":"<div class=\"groupBubble\">\n  {{$data.$item.groupName}}\n</div>","classes":"","expressions":{},"content":[{"groupName":"Test"},{"groupName":"NK"}]}],"expressions":{}},{"name":"staticMainMenu","type":"area","item-type":"static","_auto_id_":"7d48f71e-7ffd-4df4-8f53-5be221467ba8","content":[{"name":"htmlHeading","type":"content","item-type":"html","_auto_id_":"e5f0ab5b-bd97-4bf4-9896-46d359c541cc","content":"<h2>Direct Messages</h2>","expressions":{}},{"name":"lstCurrentChats","type":"content","item-type":"list","_auto_id_":"77861be5-2421-4ce8-b7ec-2aa70ff7a26e","title":"List","edit":false,"search":false,"static":false,"row":"<div class=\"chatRow\">\n  <div class=\"background\" index=\"{{$data.$item.$index}}\" ontouchend=\"cti.deleteChat(event)\" onclick=\"cti.deleteChat(event)\">\n    <p></p>\n  </div>\n  \n  <div class=\"foreground\">\n    <p class=\"userIcon {{$data.$item.participants[0].status}}\"><span class=\"icon\">\n      <img src=\"{{$data.$item.participants[0].vcard.avatar || $store.variables.defaultAvyPlaceholder}}\" width=\"45\" height=\"45\" />\n      </span><span class=\"status\"></span></p>\n    <p class=\"user\">{{$data.$item.type === 'single' ? $data.$item.participants[0].nickname || $data.$item.participants[0].username : $data.$item.chatName}}</p>\n  </div>\n</div>","classes":"","expressions":{},"model":"$store.currentChats","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.currentChat = $data.$item;\ndocument.querySelector('div#Friends').style.display = 'none';\n//debugger;\ncti.utils.callAction('go-to-page', { name: 'Chat' });"},"_auto_id_":"291d42b5-5f50-4f02-8740-5da3953fc8c4"}]}],"expressions":{}},{"name":"staticSelf","type":"area","item-type":"static","_auto_id_":"70791819-bbf2-4371-b06a-f886c2d45635","content":[{"name":"htmlSelf","type":"content","item-type":"html","_auto_id_":"0f5d0b66-ceb8-4718-8416-e2fcaa093319","content":"<p class=\"userIcon chat\">\n  <span class=\"icon\">\n    <img class=\"currentUserAvy\" src=\"{{'$store.currentJidProfile.avatar' | store}}\" width=\"45\" height=\"45\" />\n  </span>\n  <span class=\"status {{'$store.xmpp.xmppChatbox.connection_status' | store}}\"></span>\n</p>\n<p class=\"user chat\">{{'$store.currentJidProfile.nickname' | store}}</p>","expressions":{}},{"name":"btnSettings","type":"button","item-type":"button","_auto_id_":"751978d8-e2ff-470f-8052-4eecc976f619","content":"","theme":"default","left-icon":"fa-cog","expressions":{},"actions":[{"event":"click","type":"call-component-function","data":{"page":"Friends","componentInstanceId":"1a2ed49a-a728-4566-bdaf-2c68d9a3b524","function":"show"},"_auto_id_":"95565aff-f5db-411a-b7c3-43ec5bec2c60"}]}],"expressions":{}}],"componentId":"138ad233-ef5b-4da6-919f-50ff3bc70da3","_auto_id_":"edeec319-d729-4313-82dd-e5a31a3f0207","attributes":{"Direction":"left"},"expressions":{}},{"name":"ppProfile","type":"component","item-type":"web-component","content":[{"name":"htmlProfileTop","type":"content","item-type":"html","_auto_id_":"7bac3922-ba88-419b-bf74-687f84a087f2","content":"<h2>{{'$store.selectedUser.vcard.nickname || $store.selectedUser.username' | store}}</h2>","expressions":{},"classes":"ppTop"}],"componentId":"956d0c7c-84ba-4c5b-a561-0149c4a9c15c","_auto_id_":"4fc2dd94-2f81-457e-980a-85b0510ee779","attributes":{"Direction":"right","Callback":""},"expressions":{}},{"name":"ppSettings","type":"component","item-type":"web-component","content":[{"name":"htmlTop","type":"content","item-type":"html","_auto_id_":"5c7538aa-ef18-4a33-84bf-ab43a3a1aff8","content":"<h2>{{'$store.currentJidProfile.nickname' | store}}</h2>","expressions":{},"classes":"ppTop"},{"name":"btnEditProfile","type":"button","item-type":"button","_auto_id_":"ad872a31-c196-4edd-9a17-cbb42e565576","content":"Edit Profile","theme":"default","actions":[{"event":"click","type":"call-component-function","data":{"page":"Friends","componentInstanceId":"2a7cfbce-bc70-4f19-8710-5e54ee600ea4","function":"show"},"_auto_id_":"322f7cbc-400f-49b5-895d-98da71cc7c7b"}],"expressions":{}},{"name":"btnChangeAvatar","type":"button","item-type":"button","_auto_id_":"6075cf98-bedc-4675-8c0a-cea82af1fedd","content":"Change Avatar","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"//window.ldr = document.querySelector('activity-loader');\n//window.ldr.updateText('Running CSI image analyser...');\n//window.popFail = document.querySelector('#popFail');\n\nwindow.navigator.camera.getPicture(photoSuccess, function(r) { console.log('ERROR: %s', r)}, {  \n\tquality: 75,  \n\tdestinationType: 0,  \n\tsourceType: 1,  \n\tallowEdit: false,  \n\tencodingType: 0,  \n\tsaveToPhotoAlbum: true,  \n\tcorrectOrientation: false,\n\tcameraDirection: 1,\n    targetWidth: 810,\n    targetHeight: 1080\n});\n\nfunction photoSuccess(imgData) {\n  //window.ldr.show();\n  var blob = convertToBlob(imgData);\n  \n  var req = new XMLHttpRequest();  \n  req.open('POST', 'https://westus.api.cognitive.microsoft.com/face/v1.0/detect', true);  \n  req.setRequestHeader('Content-Type', 'application/octet-stream');  \n  req.setRequestHeader('Ocp-Apim-Subscription-Key', '6a57e4bddeab4fb5961b3b2383408d2d');  \n  req.send(blob);\n\n  req.onreadystatechange = function(r) {\n    if(req.readyState === XMLHttpRequest.DONE && req.status === 200) {\n      var apiRes = JSON.parse(req.responseText);\n\n      console.log(JSON.parse(req.responseText));\n\n      var image = new Image();\n      image.src = 'data:image/png;base64,' + imgData;\n      image.onload = function() {\n        debugger;\n        var canvas = document.createElement('canvas');\n        canvas.width = 45;\n        canvas.height = 45;\n        \n        var ctx = canvas.getContext('2d');\n        ctx.drawImage(image, \n                      apiRes[0].faceRectangle.left, \n                      apiRes[0].faceRectangle.top, \n                      apiRes[0].faceRectangle.width, \n                      apiRes[0].faceRectangle.height, \n                      0, \n                      0, \n                      45, \n                      45);\n\n        var base64ImageData = canvas.toDataURL();\n        var rawb64Img = base64ImageData.split(',')[1];\n        var newBlob = convertToBlob(rawb64Img);\n        \n        if(cti.store.currentJidProfile.avatar.indexOf('userAvatars') > -1) {\n          window.resolveLocalFileSystemURL(cti.store.currentJidProfile.avatar, function(entry) { \n            entry.remove(function() {\n              console.log('File deleted');\n              saveToDisk(newBlob, rawb64Img);\n            }, function() {\n              console.log('File delete failed, proceeding with new avatar');\n              saveToDisk(newBlob, rawb64Img);\n            });\n          }, function(e) {\n            console.log(e);\n            console.log('Cannot resolve file entry, proceeding with new avatar');\n            saveToDisk(newBlob, rawb64Img); \n          })\n        }\n        else {\n          saveToDisk(newBlob, rawb64Img); \n        }\n      }\n    }\n  }\n}\n\nfunction saveToDisk(blob, rawb64Img) {\n  var avyFileName = cti.newGuid() + '.png';\n  \n  window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fs) {\n    fs.root.getFile(avyFileName, { create: true }, function(fileEntry) {\n      fs.root.getDirectory('userAvatars', { create: true }, function(dir) {\n        fileEntry.moveTo(dir, avyFileName, function(newEntry) {\n          console.log(newEntry.fullPath);\n          console.log(newEntry.toURL());\n          cti.store.currentJidProfile.avatar = newEntry.toURL();\n\n          newEntry.createWriter(function(fw) {\n            fw.onwriteend = function() {\n              console.log('Write complete');\n              //document.querySelector('#ppSettings').hide();\n              cti.utils.updatePage();\n              window.xmppExtensions.vcard.setVCard(cti.store.currentJidProfile, true, rawb64Img)\n            }\n\n            fw.onerror = function(err) {\n              console.log(err);  \n            }\n\n            fw.write(blob);\n          })\n        });  \n      }); \n    });\n  });\n}\n\n\nfunction convertToBlob(imgData) {\n  var sliceSize = 512;\n  var byteCharacters = atob(imgData);\n\n  byteCharacters = atob(imgData);\n  var byteArrays = [];\n\n  for(var offset = 0; offset < byteCharacters.length; offset += sliceSize) {    \n    var slice = byteCharacters.slice(offset, offset + sliceSize);        \n    var byteNumbers = new Array(slice.length);    \n\n    for(var i = 0; i < slice.length; i++) {      \n      byteNumbers[i] = slice.charCodeAt(i);   \n    }        \n\n    var byteArray = new Uint8Array(byteNumbers);    \n    byteArrays.push(byteArray);  \n  }\n\n  return new Blob(byteArrays, { type: 'image/png'});\n}"},"_auto_id_":"e315b331-3288-4bfd-80fd-4e33fc65d842"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"0ed47a5b-381a-4028-8e41-4ef5fd5f0868","content":"Logout","theme":"default","expressions":{},"actions":[{"event":"click","type":"call-component-function","data":{"page":"Friends","componentInstanceId":"1a2ed49a-a728-4566-bdaf-2c68d9a3b524","function":"hide"},"_auto_id_":"4da8ff92-1e4c-41b0-a722-8b0fd89d4f96"},{"event":"click","type":"xmpp-logout","data":{"name":"xmppChatbox"},"_auto_id_":"df0a4c36-b0c6-44e6-bb23-70dde378f134"},{"event":"click","type":"go-to-page","data":{"name":"Splash","isConditional":false},"_auto_id_":"971b6630-7f34-47a1-b5de-0df90aec86b7"}]}],"componentId":"956d0c7c-84ba-4c5b-a561-0149c4a9c15c","_auto_id_":"1a2ed49a-a728-4566-bdaf-2c68d9a3b524","attributes":{"Direction":"up"},"expressions":{},"actions":[]},{"name":"ppStartChat","type":"component","item-type":"web-component","content":[{"name":"staticStartChat","type":"area","item-type":"static","_auto_id_":"34d083a8-b78f-46ea-8661-a353a1a3a5db","content":[{"name":"txtTo","type":"user-input","item-type":"text","_auto_id_":"7fea4fc4-f76a-411f-810e-f248c901f281","label":"To:","required":false,"multiline":false,"debounce":250,"expressions":{}},{"name":"btnStartChat","type":"button","item-type":"button","_auto_id_":"2fb6fe4c-2518-417b-9c5a-a75085d6a64d","content":"Start","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"if(!cti.store.currentChats) cti.store.currentChats = [];\n\nif(cti.store.newChat.length === 1) {\n  for(var i = 0; i < cti.store.currentChats.length; i++) {\n    var c = cti.store.currentChats[i];\n    \n    if(c.chatUser === cti.store.newChat[0].username) {\n      cti.store.currentChat = c;\n      cti.clearNewChat();\n      cti.utils.callAction('go-to-page', { name: 'Chat' });\n      return;\n    }\n  }\n  \n  var newChat = {\n    participants: cti.store.newChat,\n\tchatUser: cti.store.newChat[0].username,\n    chatName: cti.store.newChat[0].nickname || cti.store.newChat[0].username,\n    history: [],\n    createdOn: new Date(),\n    createdBy: cti.api.xmpp_connection.jid.split('/')[0],\n    type: 'single'\n  }\n  \n  cti.store.currentChat = newChat;\n  cti.store.currentChats.push(newChat);\n  cti.clearNewChat();\n  cti.utils.callAction('go-to-page', { name: 'Chat' });\n}\nelse {\n  // TODO: Add new page for configuring group chat options\n}"},"_auto_id_":"36d50421-1ecf-4c0d-a499-b83c212cd4bc"}]}],"expressions":{}},{"name":"scrlStartChat","type":"area","item-type":"scrollable","_auto_id_":"7a59bb47-b23c-456d-8375-122de3de35c7","content":[{"name":"lstStartChat","type":"content","item-type":"list","_auto_id_":"e989316c-8a39-4b72-8ec0-0a0a13119e1d","title":"List","edit":false,"search":false,"static":false,"row":"<div class=\"userRow\">\n  <p class=\"user {{$data.$item.status}}\">\n    {{$data.$item.nickname || $data.$item.username}}\n  </p>\n</div>","classes":"","expressions":{},"model":"$store.xmpp.xmppChatbox.contacts","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var user = $data.$item.nickname || $data.$item.username.split('@')[0];\n\nif(!cti.store.newChat) cti.store.newChat = [];\n\nif(cti.store.pages.Friends && cti.store.pages.Friends.txtTo) {\n  if(cti.store.pages.Friends.txtTo.indexOf(user) === -1) {\n   \tcti.store.pages.Friends.txtTo += ', ' + user;\n    cti.store.newChat.push($data.$item);\n  }\n}\nelse {\n  if(cti.store.pages.Friends) {\n    cti.store.pages.Friends.txtTo = user;\n    cti.store.newChat.push($data.$item);\n  }\n  else {\n    cti.store.pages.Friends = {\n      txtTo: user\n    }\n    cti.store.newChat.push($data.$item);\n  }\n}"},"_auto_id_":"ced38abd-e93c-4ea3-898b-d6c7bc4a715e"}]}],"expressions":{}}],"componentId":"956d0c7c-84ba-4c5b-a561-0149c4a9c15c","_auto_id_":"f65a66ce-5511-4ab9-86e6-e97653864ead","attributes":{"Direction":"down","Callback":"cti.clearNewChat"},"expressions":{},"actions":[]},{"name":"ppEditProfile","type":"component","item-type":"web-component","content":[{"name":"htmlEditProfile","type":"content","item-type":"html","_auto_id_":"68820168-909e-4d38-96d0-8d9af8d74ce0","content":"<h2>Edit Profile</h2>","expressions":{},"classes":"ppTop"},{"name":"txtDisplayName","type":"user-input","item-type":"text","_auto_id_":"ac948442-5464-437f-a2fd-64b1c6aaa7de","label":"Display Name","required":false,"multiline":false,"debounce":250,"placeholder":"","expressions":{}},{"name":"emlEmail","type":"user-input","item-type":"email","_auto_id_":"3ea550dd-31b9-4d71-8045-e8653fbe9c57","label":"Email","required":false,"expressions":{}}],"componentId":"956d0c7c-84ba-4c5b-a561-0149c4a9c15c","_auto_id_":"2a7cfbce-bc70-4f19-8710-5e54ee600ea4","attributes":{"Direction":"right","Callback":"cti.updateVCard"},"expressions":{}}],"expressions":{}}]},{"start":false,"name":"Chat","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnBack","type":"button","item-type":"button","_auto_id_":"03cc0aef-ab35-4c45-83c9-592ac802430e","content":"","theme":"default","left-icon":"fa-arrow-left","expressions":{},"actions":[{"event":"click","type":"go-to-page","data":{"name":"Friends","isConditional":false},"_auto_id_":"f1a1fdc9-eb27-4e58-9391-126e37a6b841"}]},{"name":"title","type":"content","item-type":"title","content":"<h1 class=\"{{'$store.currentChat.participants[0].status' | store}}\">{{'$store.currentChat.chatName' | store}}</h1>","_auto_id_":"867058dd-fa37-448d-92cf-bc4cdfaceb45"},{"name":"btnMenu","type":"button","item-type":"button","_auto_id_":"103367da-27c3-4b9c-9456-cb7294d1ec38","content":"","theme":"default","left-icon":"fa-users","expressions":{},"actions":[{"event":"click","type":"call-component-function","data":{"page":"Chat","componentInstanceId":"23068f3c-46b9-4920-9d92-9f449a7253a4","function":"toggle"},"_auto_id_":"05b03f6b-9a52-4147-8d52-1f26b0ada980"}]}],"_auto_id_":"e4d59712-bd1a-47dc-9d2c-effc56d028e6"},{"name":"scrlChatHistory","type":"area","item-type":"scrollable","content":[{"name":"lstChatHistory","type":"content","item-type":"list","_auto_id_":"2958bde7-caab-47ca-b5ea-a5750c06200c","title":"List","edit":false,"search":false,"static":false,"row":"<div class=\"historyRow\">\n  <p class=\"from\">{{$store.currentJidProfile.user === $data.$item.from ? $store.currentJidProfile.nickname : $store.currentChat.participants[0].nickname || $data.$item.from}} <span>{{$data.$item.ts | date : format : 'short'}}</span></p>\n  <p>{{$data.$item.body}}</p>\n</div>","classes":"","expressions":{},"model":"$store.currentChat.history","autoscroll":true}],"_auto_id_":"135994af-7769-4930-a285-25536acdf694","expressions":{}},{"name":"nav_footer","type":"area","item-type":"button-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnAttach","type":"button","item-type":"button","_auto_id_":"0cb0fa7a-1d1e-4082-be5e-bec9f8e06173","content":"","theme":"default","left-icon":"fa-paperclip","expressions":{},"actions":[{"event":"click","type":"call-component-function","data":{"page":"Chat","componentInstanceId":"dd720491-38bb-4202-be7a-bf052991d52d","function":"toggle"},"_auto_id_":"fc13933c-d2e6-4abb-9a2f-d9f15c1fc7ad"}]},{"name":"txtMessage","type":"user-input","item-type":"text","_auto_id_":"fd744a81-4d8e-4125-9f17-a17720ef2d3f","label":"","required":true,"multiline":false,"debounce":250,"placeholder":"Message...","expressions":{},"message":"This is a required field","validators":[]},{"name":"btnSend","type":"button","item-type":"button","_auto_id_":"0fa991c8-37fb-4cd7-90b7-7dd24fd2c2e6","content":"Send","theme":"default","expressions":{"disabled":"$form.invalid === true"},"actions":[{"event":"click","type":"send-xmpp-message","data":{"name":"xmppChatbox","to":"{{$store.currentChat.participants[0].username}}","message":"{{$store.pages.Chat.txtMessage}}","metadata":{"type":"{{$store.currentChat.type}}"}},"_auto_id_":"f7421363-97f3-4d85-af0e-cdb001005665"},{"event":"click","type":"set-model","data":{"location":"$store.pages.Chat.txtMessage"},"_auto_id_":"d01c002a-b731-40ca-9537-22e0cc5e20ef"},{"event":"click","type":"inline-function","data":{"sync":true,"code":"var currentChat = cti.store.currentChat;\ncurrentChat.history = cti.store.xmpp.xmppChatbox.history[cti.store.currentChat.participants[0].username].messages;\ncti.store.currentChat = currentChat;"},"_auto_id_":"cd3e4fbc-8bd4-419d-8ff8-97ca9d666223"}]}],"_auto_id_":"0c5d1956-3d7b-4793-8f8a-25a1491480ec"},{"name":"staticContainer","type":"area","item-type":"static","_auto_id_":"91d58ce5-7a93-4ff7-a3df-9b5f016a883b","content":[{"name":"toastChatAttachments","type":"component","item-type":"web-component","content":[{"name":"btnCamera","type":"button","item-type":"button","_auto_id_":"a9b9ea77-5313-4889-b2f8-68ff2816cdfa","content":"Camera","theme":"default","expressions":{}},{"name":"btnGallery","type":"button","item-type":"button","_auto_id_":"abb6326d-db3d-4db0-88b0-061f8cfaf244","content":"Gallery","theme":"default","expressions":{}}],"componentId":"c33912c4-f2bf-4b80-8324-b455ba212bfc","_auto_id_":"dd720491-38bb-4202-be7a-bf052991d52d","attributes":{},"expressions":{}},{"name":"menuParticipants","type":"component","item-type":"web-component","content":[{"name":"scrlParticipants","type":"area","item-type":"scrollable","_auto_id_":"63e0682e-2418-4539-b2ab-d79f59ae7dd5","content":[{"name":"htmlTitle","type":"content","item-type":"html","_auto_id_":"61a137e0-1453-4f82-8d5e-4d08ed704d7a","content":"<h2>Participants</h2>","expressions":{}},{"name":"lstParticipants","type":"content","item-type":"list","_auto_id_":"f86b8cac-afed-4ee4-bf6b-13d798a4e42b","title":"List","edit":false,"search":false,"static":false,"row":"<div class=\"chatRow\">\n  <div class=\"foreground\">\n    <p class=\"userIcon {{$data.$item.status}}\"><span class=\"icon\">\n      <img src=\"{{$data.$item.vcard.avatar || $store.variables.defaultAvyPlaceholder}}\" width=\"45\" height=\"45\" />\n      </span><span class=\"status\"></span></p>\n    <p class=\"user\">{{$data.$item.nickname || $data.$item.username}}</p>\n  </div>\n</div>","classes":"","model":"$store.currentChat.participants","expressions":{}}],"expressions":{}}],"componentId":"138ad233-ef5b-4da6-919f-50ff3bc70da3","_auto_id_":"23068f3c-46b9-4920-9d92-9f449a7253a4","attributes":{"Direction":"right"},"expressions":{}}],"expressions":{}}]}],"actionflows":[],"dataflows":[],"config":[{"name":"chatbox2Styles","type":"style","item-type":"css-asset","_auto_id_":"a95b0ee4-1208-40cd-957d-a6d403b0d72d","fileName":"chatbox2.css"},{"name":"font_asset_1","type":"style","item-type":"font-asset","_auto_id_":"b948b8f7-cd77-43a9-b701-8ad4962a1ef7","fileName":"OpenSans-Regular.ttf"},{"name":"font_asset_2","type":"style","item-type":"font-asset","_auto_id_":"65458b48-9682-48bc-b359-78233ae36f78","fileName":"OpenSans-Semibold.ttf"},{"name":"popupBg","type":"style","item-type":"image-asset","_auto_id_":"15586b29-0026-49db-b0a6-40e9f777fdb5","fileName":"popupBg.png"},{"name":"defaultAvy","type":"style","item-type":"image-asset","_auto_id_":"18d04599-963a-47d8-8699-a4a3fefb0278","fileName":"defaultAvy.png"},{"name":"xmppChatbox","type":"integration","item-type":"xmpp","_auto_id_":"b636564a-0a78-4da7-af0f-e815e864ffcc","ping-time":5000,"ping-timeout":5000,"endpoint":"ws://192.168.3.29:5280/websocket","stay-connected":true,"actions":[{"event":"connected","type":"inline-function","data":{"sync":true,"code":"console.log('Connected');\n\nif(!window.connected) {\n  window.connected = true;\n  console.log('Window.connected = false');\n  \n  if(!cti.store.friendsState) {\n    cti.store.friendsState = {\n      filter: 'all',\n      list: cti.store.xmpp.xmppChatbox.contacts\n    }\n  }\n  else {\n     cti.store.friendsState.list = cti.store.xmpp.xmppChatbox.contacts\n  }\n\n  if(!cti.store.currentJidProfile) {\n    cti.store.currentJidProfile = {\n      nickname: cti.api.xmpp_connection.jid.split('/')[0],\n      avatar: cti.store.variables.defaultAvyPlaceholder\n    }\n  }\n  else {\n    if(!cti.store.currentJidProfile.nickname) {\n      cti.store.currentJidProfile.nickname = cti.api.xmpp_connection.jid.split('/')[0];\n    }\n\n    if(!cti.store.currentJidProfile.avatar) {\n      cti.store.currentJidProfile.avatar = cti.store.variables.defaultAvyPlaceholder;\n    }\n  }\n\n  cti.store.currentJidProfile.user = cti.api.xmpp_connection.jid.split('/')[0];\n\n  if(!cti.store.currentChats) {\n    cti.store.currentChats = []; \n  }\n\n  if(cti.store.state.currentPage === 'Splash') {\n    cti.utils.callAction('go-to-page', { name: 'Friends' }); \n  }\n\n  //if(window.xmppExtensions === undefined) {\n    window.xmppExtensions = new NkXmppExtensions({\n      vcard: true,\n      roster: true\n    }); \n  //}\n\n  // TODO: Check if profiles already have been downloaded\n  setTimeout(function() {\n    console.log('Timeout exceeded');\n    window.xmppExtensions.vcard.requestAllRosterProfiles(true);\n  }, 5000);\n}"},"_auto_id_":"8e6ffcb7-6b2f-4cb2-897d-5afc428153b6"},{"event":"reconnected","type":"inline-function","data":{"sync":true,"code":"console.log('Reconnected');\n\nif(!cti.store.friendsState) {\n  cti.store.friendsState = {\n  \tfilter: 'all',\n    list: cti.store.xmpp.xmppChatbox.contacts\n  }\n}\nelse {\n   cti.store.friendsState.list = cti.store.xmpp.xmppChatbox.contacts\n}\n\n//window.xmppExtensions.vcard.requestAllRosterProfiles(true);"},"_auto_id_":"2871cd72-2073-4a95-ac09-210e392c6cbb","actions":[]},{"event":"contacts-update","type":"inline-function","data":{"sync":true,"code":"var list = [];\nvar filter = cti.store.friendsState.filter;\n\nfor(var i = 0, max = cti.store.xmpp.xmppChatbox.contacts.length; i < max; i++) {\n\tvar c = cti.store.xmpp.xmppChatbox.contacts[i];\n\n    if(filter === 'online') {\n      if(c.status === 'chat') {\n\t\tlist.push(c);\n\t  }\n    }\n    else if(filter === 'pending') {\n      if(c.subscriptionStatus === 'none' || c.subscriptionStatus === 'awaiting') {\n\t\tlist.push(c);\n\t  } \n    }\n    else {\n      list.push(c); \n    }\n}\n\ncti.store.friendsState = {\n\tfilter: 'online',\n\tlist: list\n}"},"_auto_id_":"3aa4ff8c-494b-42fa-8acc-c10a8b5be784"},{"event":"message-received","type":"inline-function","data":{"sync":true,"code":"console.log($data.$message);\nvar currentChats = cti.store.currentChats;\nvar newChat = true;\n\nif(cti.store.xmpp.xmppChatbox.history[$data.$message.from]) {\n  for(var i = 0; i < currentChats.length; i++) {\n    var c = currentChats[i];\n\n    if(c.type === $data.$message.metadata.type && c.chatUser === $data.$message.from) {\n      newChat = false;\n      c.history = cti.store.xmpp.xmppChatbox.history[$data.$message.from].messages;\n      break;\n    }\n  }\n}\n\ncti.store.currentChats = currentChats;\n\nif(newChat) {\n  var contacts = cti.store.xmpp.xmppChatbox.contacts;\n  var friend = null;\n\n  for(var i = 0; i < contacts.length; i++) {\n    var c = contacts[i];\n\n    if(c.username === $data.$message.from) {\n      friend = c;\n      break;\n    }\n  }\n\n  if($data.$message.metadata.type === 'single' && friend !== null) {\n    var newChat = {\n      participants: [friend],\n      chatUser: $data.$message.from,\n      chatName: friend.nickname || friend.username,\n      history: [$data.$message],\n      createdOn: new Date(),\n      createdBy: $data.$message.from,\n      type: 'single'\n    } \n    }\n  else {\n    // TODO: group chat\n  }\n\n  cti.store.currentChats.push(newChat);\n}"},"_auto_id_":"bee14525-b859-4a87-8809-0f78c3e67380"},{"event":"authentication-failed","type":"show-notification","data":{"options":{"schedule":false,"dynamic":true},"name":"xmppLoginFailure"},"_auto_id_":"73dcd45c-0c82-402f-b3b8-45553a14b287"}]},{"name":"function_1","type":"scripting","item-type":"function","_auto_id_":"25f2353c-a694-424c-a494-c6b5877ff0bb","sync":true,"params":[]},{"name":"xmppLoginFailure","type":"notification","item-type":"app-notification","_auto_id_":"ff8e4b8a-d21c-4d3e-98b1-6ff9897f906d","options":{"autoDismiss":true,"closeButton":true},"style":"error","actions":[],"title":"Failed to login","text":"Please try again"},{"name":"xmppExtensions","type":"scripting","item-type":"js-asset","_auto_id_":"a21dc03c-0899-494c-8937-4984e11ac0c9","fileName":"xmppExtensions.js"},{"name":"updateVCard","type":"scripting","item-type":"function","_auto_id_":"d41b7abe-65b1-44e4-bda2-171f0cd0c7dc","sync":true,"params":[],"actions":[],"content":"if(cti.store.pages.Friends) {\n  var nickname = cti.store.pages.Friends.txtDisplayName;\n  var email = cti.store.pages.Friends.emlEmail;\n  \n  var profile = {};\n  if(nickname) profile.nickname = nickname;\n  if(email) profile.nickname = email;\n  \n  window.xmppExtensions.vcard.setVCard(profile);\n}"},{"name":"clearNewChat","type":"scripting","item-type":"function","_auto_id_":"821de144-6d77-4e34-9694-460b572ed511","sync":true,"params":[],"content":"if(cti.store.pages.Friends) delete cti.store.pages.Friends.txtTo;\ndelete cti.store.newChat;\ncti.utils.updatePage();"},{"name":"mapContactReferences","type":"scripting","item-type":"function","_auto_id_":"9faba668-0e45-404e-9f46-c6148cd78e17","sync":true,"params":[],"content":"\nvar roster = cti.store.xmpp.xmppChatbox.contacts;\nvar currentChats = cti.store.currentChats;\n\nfor(var c = 0; c < currentChats.length; c++) {\n  var currChat = currentChats[c];\n  var participants = currChat.participants;\n  \n  for(var p = 0; p < participants.length; p++) {\n    for(var i = 0; i < roster.length; i++) {   \n      if(roster[i].username === participants[p].username) {\n         participants[p] = roster[i];\n      }\n    }\n  }\n\n  if(currChat.type === 'single') {\n    currChat.chatName = participants[0].nickname || currChat.chatName;\n    if(cti.store.xmpp.xmppChatbox.history[currChat.participants[0].username]) {\n      currChat.history = cti.store.xmpp.xmppChatbox.history[currChat.participants[0].username].messages || [];\n    }\n  }\n  \n  if(cti.store.currentChat) {\n    if(currChat.createdOn === cti.store.currentChat.createdOn) {\n       cti.store.currentChat = currChat;\n    }\n  }\n}\n\ncti.store.currentChats = currentChats;\ncti.utils.updatePage();"},{"name":"slideToReveal","type":"scripting","item-type":"js-asset","_auto_id_":"91cd5bca-3775-4f2f-9892-a978cb7d67e0","fileName":"slideToReveal.js"},{"name":"deleteChat","type":"scripting","item-type":"function","_auto_id_":"cff6db13-7a90-41e3-91aa-0c3383a6e034","sync":true,"params":[{"name":"e","description":"Event","required":true}],"content":"e.stopPropagation();\ne.stopImmediatePropagation();\n\nconsole.log('Delete chat fired, type: %s', e.type);\nconsole.log('Index: %s', index);\n\nif(e.type === 'click') {\n  var index = parseInt(e.currentTarget.getAttribute('index'));\n  \n  var chat = cti.store.currentChats[index];\n  \n  if(chat.type === 'single') {\n    delete cti.store.xmpp.xmppChatbox.history[chat.chatUser];\n    cti.store.currentChats.splice(index, 1);\n  }\n  \n  cti.utils.updatePage();\n}"},{"name":"newGuid","type":"scripting","item-type":"function","_auto_id_":"6c38b9cf-fe28-4cc7-937f-947e67c295cd","sync":true,"params":[],"content":"var d = new Date().getTime();\n\nif(window.performance && typeof window.performance.now === \"function\"){\n  d += performance.now(); //use high-precision timer if available\n}\n\nvar uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n  var r = (d + Math.random()*16)%16 | 0;\n  d = Math.floor(d/16);\n  return (c=='x' ? r : (r&0x3|0x8)).toString(16);\n});\n\nreturn uuid;"},{"name":"defaultAvyPlaceholder","type":"scripting","item-type":"variable","_auto_id_":"0b62c59c-0af9-4710-9d51-4354bc1f9d42","variable-type":"string","value":"user-assets/defaultAvy.png"}],"components":[{"name":"CTPopup","description":"","icon":"fa-external-link","_auto_id_":"6eade5b7-4ac6-468a-8e75-49a64850f7ba","tagName":"ct-popup-box","type":"web-component","format":"javascript","typeVersion":"1","annotations":{"attributes":[{"name":"id","description":"","type":"string","enum":null,"required":true}],"functions":[{"name":"togglePopup","description":"Toggles the menu opened and closed based on the value\nof the this.opened property (initially set to false)","params":[],"returnType":"void","returnEnum":null}]},"userConfig":{},"valid":true,"files":{"original":"CTPopup.js","transpiled":"CTPopup.output.js"}},{"name":"PagePopup","description":"","icon":"fa-square","_auto_id_":"956d0c7c-84ba-4c5b-a561-0149c4a9c15c","tagName":"ct-page-popup","type":"web-component","format":"javascript","typeVersion":"1","annotations":{"attributes":[{"name":"Direction","description":"","type":"string","enum":null,"required":false},{"name":"Callback","description":"","type":"string","enum":null,"required":false}],"functions":[{"name":"show","description":"Shows the page","params":[],"returnType":"void","returnEnum":null},{"name":"hide","description":"Hide the page opened","params":[],"returnType":"void","returnEnum":null}]},"userConfig":{},"valid":true,"files":{"original":"PagePopup.js","transpiled":"PagePopup.output.js"}},{"name":"ContextMenu","description":"","icon":"fa-puzzle-piece","_auto_id_":"138ad233-ef5b-4da6-919f-50ff3bc70da3","tagName":"ct-context-menu","type":"web-component","format":"javascript","typeVersion":"1","annotations":{"attributes":[{"name":"MinWidth","description":"","type":"number","enum":null,"required":false},{"name":"Direction","description":"","type":"string","enum":null,"required":false},{"name":"Overlay","description":"","type":"boolean","enum":null,"required":false}],"functions":[{"name":"toggle","description":"Toggles the page opened and closed based on the value\nof the this.opened property (initially set to false)","params":[],"returnType":"void","returnEnum":null}]},"userConfig":{},"valid":true,"files":{"original":"ContextMenu.js","transpiled":"ContextMenu.output.js"}},{"name":"ToastMenu","description":"","icon":"fa-tasks","_auto_id_":"c33912c4-f2bf-4b80-8324-b455ba212bfc","tagName":"ct-toast-menu","type":"web-component","format":"javascript","typeVersion":"1","annotations":{"functions":[{"name":"toggle","description":"Toggles the page opened and closed based on the value\nof the this.opened property (initially set to false)","params":[],"returnType":"void","returnEnum":null}]},"userConfig":{},"valid":true,"files":{"original":"ToastMenu.js","transpiled":"ToastMenu.output.js"}}],"lastSchemaUpgradeDate":"2017-02-17 15:03:07","icondata":"nicordIcon3.png","jwt":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhcHBfaWQiOiIxMDRmMzMzMS1lZTA4LTRhNWUtYjE2YS0yYzcwOTNkN2EyYmIiLCJhcHBfbmFtZSI6Ik5pY29yZCIsImJ1aWxkX2lkIjoiZmI0MThiN2ItN2IxOS00MzYzLTk5N2ItMjI3ODNkYWY2MTZjIiwiY2xpZW50X2lkIjoiYmE2NjAxODctMzI0YS00OTNlLThhOTMtMjg2NWRkZDdiNTI3IiwiY2xpZW50X3NlY3JldCI6IlVHZEZjVzl4Y25aTlRtVkVSa2RYYVVaUWNFdzNaejA5IiwiZXhwIjoxNTIwMjk0NDAwLCJmcmVxdWVuY3kiOjIxNjAwMDAwMCwiaGFzaCI6ImRjYTcwODA1ZmYwYzhkN2Y3Mjk4NjdhNDk1OGQxZWUxMmU5NTJlMmJjMWQxZTRiYjE1NWM0ZTZiYjg1ODBkMGIiLCJsaWNfZXhwIjoxNTE3NzAyNDAwLCJscF9pZCI6IjRkMWYzNTZmLTYwMmUtNGRiOC04NTc3LWY2ZmJmZWRiZDA5NyIsInBhY2thZ2VfaWQiOiJjb20uY29tbW9udGltZS5pbmZpbml0eS5OaWNvcmQiLCJyZWZyZXNoX3Rva2VuIjoiUVU1dE0xSnNjMWt6YW01RFFucHpSeXRKYm1KNVRtaEpkRFI2TVZsS1JrUlRTbFpLWWxkUWVGaDRPRDA9IiwidHlwZSI6ImZ1bGwiLCJpYXQiOjE0ODkwNzU4MDJ9.SBG2SzxsgTg6YQsmK7Tyf37lZZhVz-HKP158lhVmA9uDU-Sh37klUIDBJ4DtGEl_L7sB0qsPQXDgnrr_1j9DkOrBWkcVgeYCbnjbqjJCq3O6cPF7vNeRE-DnOP7E_vmQ15XBa_zuk1WLVLyCqGBvoPA0kt2pFi-cxfkrNn4GBVBb_NPirfNSxLBPBmZ8cO_x44RMFTvNfnqE-unw_bMaoIqp7Gy9LtmijwFDNClkBFEOKKJxgTHD83uf8rth-AC7M-tyzBTFYuid_ta5gdfdAdE-yVXaXzmwqZKok-mnd1uFgZwqTtfEHx-KWvMX8_QUOMLgIz7GlZx6pabynL32IQ","buildId":"fb418b7b-7b19-4363-997b-22783daf616c","hostContext":0}